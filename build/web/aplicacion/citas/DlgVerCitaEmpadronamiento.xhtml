<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui">

    <p:dialog id="dlgVerCitaEmpadronamiento" header="#{bundleCitas.CitaDlgVer_Title} " 
              widgetVar="wvDlgVerCitaEmpadronamiento" modal="true" showEffect="fade" hideEffect="fade" width="90%" maximizable="false"
              appendTo="@(body)" draggable="true" onShow="dlgVerCitaEmpadronamientoDialogInit()" onHide="" position="center top"
              resizable="false" style="position: absolute; top: 0; bottom: 0; right: 0; left: 0; overflow-y: scroll;" >
        <p:outputPanel id="dlgVerCitaEmpadronamientoPanel" style="text-align:left; padding:0px!important">
                
            <h:form id="dlgVerCitaEmpadronamientoForm">
                <div class="ui-fluid">

                    <p:panel id="panelVerResumen" header="#{bundleCitas.CitaDlgVer_Resumen_Title}" style="margin-bottom: 8px" >
                        <div class="ui-g" style="margin-bottom: 3px" >
                            <div class="ui-g-12 ui-md-4 ui-lg-4">
                                <p:outputLabel value="#{bundleCitas.CitaDlgVer_Tram_Label} "/>
                                <p:outputLabel value="#{citasReservadasController.turnoSeleccionado.tipoTramiteId.nombre}" style="font-weight: bold;"/>
                            </div>
                        </div>
                        <div class="ui-g" >
                            <div class="ui-g-12 ui-md-6 ui-lg-4">
                                <p:outputLabel value="#{bundleCitas.CitaDlgVer_Sede_Label} "/>
                                <p:outputLabel value="#{citasReservadasController.turnoSeleccionado.tipoSedeId.nombre}" style="font-weight: bold;"/>
                            </div>
                            <div class="ui-g-12 ui-md-3 ui-lg-4">
                                <p:outputLabel value="#{bundleCitas.CitaDlgVer_Fecha_Label} "/>
                                <p:outputLabel value="#{citasReservadasController.turnoSeleccionado.fechaTurno}" style="font-weight: bold;">
                                    <f:convertDateTime pattern="#{bundleCitas.FormatoFecha}" />
                                </p:outputLabel>
                            </div>
                            <div class="ui-g-12 ui-md-3 ui-lg-4">
                                <p:outputLabel value="#{bundleCitas.CitaDlgVer_Hora_Label} "/>
                                <p:outputLabel value="#{citasReservadasController.horaProgra}" style="font-weight: bold;"/>
                            </div>
                        </div>
                    </p:panel>
                    
                    <p:panel id="panelVerDatGen" header="#{bundleCitas.CitaDlgVer_General_Title}" style="margin-bottom: 8px" >
                        <div class="ui-g" style="margin-bottom: 3px" >
                            <div class="ui-g-12 ui-md-6 ui-lg-4">
                                <p:outputLabel value="#{bundleCitas.CitaDlgVer_TipDoc_Label} "/>
                                <p:outputLabel value="#{citasReservadasController.turnoSeleccionado.perExamenId.tipoDoc.abreviatura}" style="font-weight: bold;"/>
                            </div>
                            <div class="ui-g-12 ui-md-6 ui-lg-8">
                                <p:outputLabel value="#{bundleCitas.CitaDlgVer_NumDoc_Label} "/>
                                <p:outputLabel value="#{citasReservadasController.turnoSeleccionado.perExamenId.numDoc}" style="font-weight: bold;"/>
                            </div>
                        </div>
                        <div class="ui-g" >
                            <div class="ui-g-12 ui-md-6 ui-lg-4">
                                <p:outputLabel value="#{bundleCitas.CitaDlgVer_Nom_Label} "/>
                                <p:outputLabel value="#{citasReservadasController.turnoSeleccionado.perExamenId.nombres}" style="font-weight: bold;"/>
                            </div>
                            <div class="ui-g-12 ui-md-6 ui-lg-8">
                                <p:outputLabel value="#{bundleCitas.CitaDlgVer_Ape_Label} "/>
                                <p:outputLabel value="#{citasReservadasController.turnoSeleccionado.perExamenId.apePat} #{citasReservadasController.turnoSeleccionado.perExamenId.apeMat}" style="font-weight: bold;"/>
                            </div>
                        </div>                    
                    </p:panel>
                    <br/>  
                    <p:panel id="panelVerDatArm" header="Datos de las Armas" >
                        <p:dataTable id="armasDTView" value="#{citasReservadasController.lstDetalleArma}"
                                     var="item"
                                     rowKey="#{item.id}"
                                     emptyMessage="#{bundleCitas.MensajeNoResultados}" 
                                     paginator="false" rows="10"
                                     paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                                     rowsPerPageTemplate="10, 20"
                                     reflow="true">

                            <p:column headerText="Serie" style="font-size:92%!important" class="ui-lg-1">
                                <h:outputText value="#{item.nroSerie}"/>
                            </p:column>

                            <p:column headerText="Tipo de Arma" style="text-align: center;font-size:92%!important" class="ui-lg-1">
                                <h:outputText value="#{item.tipoArma}"/>
                            </p:column>
                            
                            <p:column headerText="Marca" style="text-align: center;font-size:92%!important" class="ui-lg-1"> 
                                <h:outputText value="#{item.marca}" />
                            </p:column>
                            
                            <p:column headerText="Modelo" style="text-align: center;font-size:92%!important" class="ui-lg-1"> 
                                <h:outputText value="#{item.modelo}" />
                            </p:column>
                            
                            <p:column headerText="Calibre" style="text-align: center;font-size:92%!important" class="ui-lg-1"> 
                                <h:outputText value="#{item.calibre}" />
                            </p:column>
                            
                            <p:column headerText="Tipo de Internamiento" style="text-align: center;font-size:92%!important" class="ui-lg-1"> 
                                <h:outputText value="#{item.tipoInternamiento}" />
                            </p:column>
                            
                            <p:column headerText="Voucher de Pago" style="text-align: center;font-size:92%!important" class="ui-lg-1"> 
                                <h:outputText value="#{item.comprobantePago.voucherSeq}" rendered="#{item.comprobantePago!=null}" />
                            </p:column>
                            
                            <p:column headerText="Importe Pagado" style="text-align: center;font-size:92%!important" class="ui-lg-1"> 
                                <h:outputText value="#{item.comprobantePago.voucherTasa}" rendered="#{item.comprobantePago!=null}" />
                            </p:column>                    

                            <p:column headerText="Acta" style="font-size:92%!important" class="ui-lg-1">
                                    <p:commandButton  id="botonVerActaArma" 
                                                      value="Ver Acta"
                                                      ajax="false"
                                                      process="@this" 
                                                      partialSubmit="true"                              
                                                      onclick="this.form.target = '_blank'" 
                                                      onblur="this.form.target = '_self'"
                                                      immediate="true" rendered="#{item.actaInternamientoId!=null}"
                                                      icon="ui-icon-circle-check"
                                                      style="background-color: #088A08;">
                                        <p:fileDownload value="#{citasReservadasController.verActaArmaEmpadronamientoPdf(item)}" contentDisposition="inline"  />
                                    </p:commandButton>
                            </p:column>
                        </p:dataTable>                                
                    </p:panel>        
                    <br/>
                                                    
                    <p:panel id="panelVerDatMuni" header="Datos de las Municiones">
                        <div class="ui-g" style="margin-bottom: 3px" >
                            <div class="ui-g-12 ui-md-5 ui-lg-5"></div>
                            <div class="ui-g-12 ui-md-2 ui-lg-2">
                                <p:commandButton  id="botonVerActaMuniciones" 
                                                              rendered="#{citasReservadasController.lstDetalleMunicion.size()>0 and citasReservadasController.actaInternamientoMunicionId!=null}"  
                                                              value="Ver Acta de Municiones"
                                                              ajax="false"
                                                              process="@this" 
                                                              partialSubmit="true"   
                                                              onclick="this.form.target = '_blank'" 
                                                              onblur="this.form.target = '_self'"
                                                              immediate="true"
                                                              icon="ui-icon-circle-check"
                                                              style="background-color: #088A08;">
                                    <p:fileDownload value="#{citasReservadasController.verActaMunicionEmpadronamientoPdf(citasReservadasController.actaInternamientoMunicionId)}" contentDisposition="inline" />                              
                                </p:commandButton>
                            </div>        
                            <div class="ui-g-12 ui-md-5 ui-lg-5"></div>
                        </div>
                            
                        <p:dataTable id="municionesDT" value="#{citasReservadasController.lstDetalleMunicion}"
                                     var="item"
                                     rowKey="#{item.id}"
                                     emptyMessage="#{bundleCitas.MensajeNoResultados}" 
                                     paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                                     rowsPerPageTemplate="10, 20"
                                     reflow="true">
                            <p:column headerText="Marca" style="text-align: center;font-size:92%!important" class="ui-lg-2">
                                <h:outputText value="#{item.marca}"/>
                            </p:column>
                            <p:column headerText="Calibre" style="text-align: center;font-size:92%!important" class="ui-lg-2">
                                <h:outputText value="#{item.calibre}"/>
                            </p:column>
                            <p:column headerText="Cantidad Munición (Unids)" style="text-align: center;font-size:92%!important" class="ui-lg-2"> 
                                <h:outputText value="#{item.cantidad}" />
                            </p:column>
                        </p:dataTable>
                    </p:panel>

                    <div class="ui-g">
                        <div class="ui-g-12 ui-md-6 ui-lg-9">&nbsp;</div>
                        <div class="ui-g-12 ui-md-6 ui-lg-3">
                            <p:commandButton value="Cerrar" actionListener="#{citasReservadasController.cerrarVerCita('EMPADRONAMIENTO')}" id="btnCancelView" 
                                             process="@this" update="@none" partialSubmit="true"/>
                        </div>
                    </div>

                </div>
                <p:blockUI block="dlgVerCitaEmpadronamientoPanel" trigger="btnCancelView" />
            </h:form>

        </p:outputPanel>
    </p:dialog>

    <script type="text/javascript">
        $("#dlgVerCitaEmpadronamiento > .ui-dialog-titlebar").attr("style", "margin:0!important; padding: 6px!important; color: #fff!important; background: #2399e5!important;"); 
        $("#dlgVerCitaEmpadronamiento > .ui-dialog-titlebar > .ui-dialog-title").attr("style", "color: #fff!important; font-size:100%!important; padding:0!important;");                
        $("#dlgVerCitaEmpadronamiento > .ui-dialog-content").attr("style", "padding:4px!important;");
        
        function dlgVerCitaEmpadronamientoDialogInit() {
            $("div[id*='panelVerResumen_content'], div[id*='panelVerDatGen_content'], div[id*='panelVerDatArm_content'], div[id*='panelVerDatMuni_content']").attr("style", "padding:0!important");
            $("div[id*='panelVerResumen_content'], div[id*='panelVerDatGen_content'], div[id*='panelVerDatArm_content'], div[id*='panelVerDatMuni_content']").children(".ui-g").children().attr("style", "padding:3px!important;");
            $("#dlgVerCitaEmpadronamiento").css('top', 10);
        }

    </script>
    
</ui:composition>
