<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui" 
      xmlns:pe="http://primefaces.org/ui/extensions">

    <ui:composition template="/template.xhtml"> 
        <ui:define name="title">
            <b>
                <h:outputText value="#{sspRegistroCursoController.obtenerTitleList()}" rendered="#{sspRegistroCursoController.estado == 'BUSCAR'}"/>
                <h:outputText value="#{sspRegistroCursoController.obtenerTitleEdit()}" rendered="#{sspRegistroCursoController.estado == 'EDITAR'}"/>
                <h:outputText value="#{sspRegistroCursoController.obtenerTitleVer()}" rendered="#{sspRegistroCursoController.estado == 'VER'}"/>
                <h:outputText value="#{sspRegistroCursoController.obtenerTitleModificatoria()}" rendered="#{sspRegistroCursoController.estado == 'RECTIFICAR'}"/>
                <h:outputText value="#{sspRegistroCursoController.obtenerTitleActualizacion()}" rendered="#{sspRegistroCursoController.estado == 'ACTUALIZAR'}"/>
            </b>
        </ui:define>
        <ui:define name="body">
            <p:growl id="mensajesGrowlCursos" autoUpdate="true" life="10000" />
            <h:form id="listForm" rendered="#{sspRegistroCursoController.estado == 'BUSCAR'}" >
                
                <h:panelGrid columns="1" id="pnlGeneral" >
                    <p:panel id="pnlBusquedaCurso" header="#{BundleBDIntegrado.sspCursos_list_busquedaCurso}" >
                        <h:panelGrid columns="2" rendered="false">
                            <p:outputLabel value="#{BundleBDIntegrado.sspCursos_list_tipoCurso}" style="display: block; width: 80px;" />
                            <p:selectOneRadio id="tipoCurso" value="#{sspRegistroCursoController.tipoCurso}" >
                                <f:selectItem itemLabel="Todos" itemValue="TODOS" />
                                <f:selectItem itemLabel="Estándar" itemValue="TP_GSSP_CURS" />
                                <f:selectItem itemLabel="Espectáculos, Certámenes y Convenciones" itemValue="TP_GSSP_CURSEVT" />
                                <p:ajax process="@this,tipoFormacion" update="@this,tipoFormacion" event="valueChange" />
                            </p:selectOneRadio>
                        </h:panelGrid>
                        <h:panelGrid columns="2">
                            <p:outputLabel value="#{BundleBDIntegrado.sspCursos_list_tipoServicio}" style="display: block; width: 80px;" />
                            <p:selectOneMenu id="tipoServicio" value="#{sspRegistroCursoController.tipoServicio}" 
                                                              >
                                               <f:selectItem itemLabel="---" itemValue="#{null}"/>
                                               <f:selectItems var="item" itemValue="#{item}" itemLabel="#{item.nombre}" value="#{sspRegistroCursoController.lstTipoServicio}"/>
                                               <p:ajax event="change" process="pnlGeneral" update="pnlGeneral" listener="#{sspRegistroCursoController.ActivarCmbFormaList() }" /> 
                            </p:selectOneMenu>
                        </h:panelGrid>
                        <h:panelGrid columns="6" >
                            <p:outputLabel value="#{BundleBDIntegrado.sspCursos_list_buscarPor} *" style="display: block; width: 80px;" />
                            <h:panelGrid columns="2" >
                                <p:selectOneMenu id="buscarPor" value="#{sspRegistroCursoController.buscarPor}" >
                                   <f:selectItem itemLabel="---" itemValue="#{null}"/>        
                                   <f:selectItem itemLabel="CÓDIGO" itemValue="1"/>
                                   <f:selectItem itemLabel="NRO. DE EXPEDIENTE" itemValue="2"/>
                                   <f:selectItem itemLabel="CE/DNI ALUMNO" itemValue="3"/>
                                   <f:selectItem itemLabel="CE/DNI INSTRUCTOR" itemValue="4"/>
                                   <p:ajax event="change" process="pnlBusquedaCurso" update="pnlBusquedaCurso" listener="#{sspRegistroCursoController.cambiarTipoBuscarPor() }" />
                                </p:selectOneMenu>
                                <p:inputText value="#{sspRegistroCursoController.filtro}" id="filtroBusqueda" 
                                             placeholder="Escriba un filtro" style="width: 150px;" >
                                    <p:keyFilter mask="int" preventPaste="false" />
                                </p:inputText>
                            </h:panelGrid>
                            <p:outputLabel value="#{BundleBDIntegrado.sspCursos_list_formacion}" style="margin-left: 20px;" />
                            <p:selectOneMenu id="tipoFormacion" value="#{sspRegistroCursoController.tipoFormacion}" >
                               <f:selectItem itemLabel="---" itemValue="#{null}"/>
                               <f:selectItems var="item" itemValue="#{item}" itemLabel="#{item.nombre}" value="#{sspRegistroCursoController.lstTipoFormacionListado}"/>
                            </p:selectOneMenu>
                            <p:outputLabel value="" />
                            <p:outputLabel value="" />
                            
                            <p:outputLabel value="#{BundleBDIntegrado.sspCursos_list_estado}" style="display: block; width: 80px;"  />
                            <p:selectOneMenu id="estado" value="#{sspRegistroCursoController.estadoCurso}" >
                               <f:selectItem itemLabel="---" itemValue="#{null}"/>
                               <f:selectItems var="item" itemValue="#{item}" itemLabel="#{item.descripcion}"
                                              value="#{sspRegistroCursoController.lstEstadosCursos}"/>
                            </p:selectOneMenu>
                            <p:outputLabel value="#{BundleBDIntegrado.sspCursos_list_fechaInicio}"/>
                            <h:panelGrid columns="4" >
                                <p:calendar id="fechaInicio"
                                            locale="es"
                                            showOn="button" value="#{sspRegistroCursoController.fechaInicio }"
                                            pattern="#{BundleBDIntegrado.FormatoFecha}" >  
                                        <f:convertDateTime pattern="#{BundleBDIntegrado.FormatoFecha}" />
                                </p:calendar>
                                <pe:tooltip for="fechaInicio"
                                    value="Ingrese la fecha de inicio de búsqueda" 
                                    showEffect="slideToggle"  
                                    hideEffect="slideToggle" 
                                    showDelay="0" 
                                    myPosition="left center" 
                                    atPosition="right center"/>
                                <p:outputLabel value="al"/>
                                <p:calendar id="fechaFin"
                                            locale="es"
                                            showOn="button" value="#{sspRegistroCursoController.fechaFinal }"
                                            pattern="#{BundleBDIntegrado.FormatoFecha}" >  
                                        <f:convertDateTime pattern="#{BundleBDIntegrado.FormatoFecha}" />
                                </p:calendar>
                            </h:panelGrid>
                            <p:commandButton value="#{BundleBDIntegrado.Buscar}" 
                                            style="margin-left: 20px;"
                                            process="@this,pnlBusquedaCurso"
                                            icon="ui-icon-search " actionListener="#{sspRegistroCursoController.buscarBandeja()}" 
                                            update="@form"/>
                            <p:outputLabel value=" "/>
                            
                            <p:outputLabel value="#{BundleBDIntegrado.sspCursos_list_nombreLocal}" />
                            <p:selectOneMenu id="nombreLocal" value="#{sspRegistroCursoController.local}" autoWidth="false" style="width:300px;" >
                               <f:selectItem itemLabel="---" itemValue="#{null}"/>
                               <f:selectItems var="item" itemValue="#{item}" itemLabel="#{item.nombreLocal}" value="#{sspRegistroCursoController.lstLocales}"/>
                            </p:selectOneMenu>
                            <p:outputLabel value=" "/>
                            <p:outputLabel value=" "/>
                            <p:outputLabel value=" "/>
                            <p:outputLabel value=" "/>
                        </h:panelGrid>
                    </p:panel>

                    <h:panelGrid columns="2" width="100%" >
                        <p:panel id="pnlEnviarCurso" header="#{BundleBDIntegrado.sspCursos_list_enviarCurso}" >
                            <p:outputLabel value="#{BundleBDIntegrado.sspCursos_list_transmitir}"/>
                            <p:commandButton value="#{BundleBDIntegrado.sspCursos_list_cambiar}" 
                                     process="@this,pnlBusquedaCurso"
                                     style="margin-left: 20px;"
                                     disabled="#{sspRegistroCursoController.disabledBtnTransmitir}"
                                     icon="ui-icon-transferthick-e-w " actionListener="#{sspRegistroCursoController.transmitirCurso()}" 
                                     onstart="PF('loadingDialog').show()"
                                     oncomplete="PF('loadingDialog').hide()"
                                     update="@form"/>
                        </p:panel>
                        <p:panel id="pnlLeyenda" header="#{BundleBDIntegrado.sspCursos_list_leyenda}" >
                            <h:panelGrid columns="10" >
                                <p:graphicImage name="/imagenes/admin_view.png" width="30"  />
                                <p:outputLabel value="#{BundleBDIntegrado.sspCursos_list_leyenda_verCurso}"/>

                                <p:graphicImage name="/imagenes/admin_pencil.png" width="30" style="margin-left: 12px;" />
                                <p:outputLabel value="#{BundleBDIntegrado.sspCursos_list_leyenda_editarCurso}"/>

                                <p:graphicImage name="/imagenes/admin_trash.png" width="30" style="margin-left: 12px;" />
                                <p:outputLabel value="#{BundleBDIntegrado.sspCursos_list_leyenda_borrarCurso}"/>

                                <p:graphicImage name="/imagenes/admin_refresh.png" width="30" style="margin-left: 12px;" />
                                <p:outputLabel value="#{BundleBDIntegrado.sspCursos_list_leyenda_modificatoriaCurso}"/>
                                
                                <p:graphicImage name="/imagenes/admin_print.png" width="30" style="margin-left: 12px;" />
                                <p:outputLabel value="#{BundleBDIntegrado.sspCursos_list_leyenda_imprimirConstancia}"/>
                            </h:panelGrid>
                        </p:panel>
                    </h:panelGrid>
                    <br/>
                    
                    <p:fieldset legend="Leyenda" rendered="#{sspRegistroCursoController.resultadosBandeja.size() > 0}" >
                        <h:panelGrid columns="3" style="border: 0px;">
                            <h:panelGrid columns="2" >
                                <h:panelGrid style="width: 20px; height: 20px;border-style: solid;border-width: 1px;"  />
                                <h:outputText value="Transmitido" />
                            </h:panelGrid>
                            <h:panelGrid columns="2" >
                                <h:panelGrid style="width: 20px; height: 20px;" class="datatableCursos-row-apto" />
                                <h:outputText value="Apto para transmitir" />
                            </h:panelGrid>
                            <h:panelGrid columns="2" >
                                <h:panelGrid style="width: 20px; height: 20px;" class="datatableCursos-row-noApto" />
                                <h:outputText value="Pendiente de confirmación" />
                            </h:panelGrid>
                        </h:panelGrid>
                    </p:fieldset>
                    <p:dataTable id="buscarDatatableRegistro" value="#{sspRegistroCursoController.resultadosBandeja}"
                                     var="itemReg"
                                     rowKey="#{itemReg.id}"
                                     selection="#{sspRegistroCursoController.resultadosBandejaSeleccionados}"
                                     emptyMessage="#{BundleBDIntegrado.MensajeNoResultados}"
                                     paginator="true" rows="#{BundleBDIntegrado.PaginatorFilas}"
                                     paginatorTemplate="{CurrentPageReport}  {FirstPageLink} 
                                     {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} 
                                     {RowsPerPageDropdown}"
                                     currentPageReportTemplate="Total {totalRecords} registro(s)"
                                     rowStyleClass="#{sspRegistroCursoController.obtenerColoRegistroApto(itemReg)}" 
                                     rowsPerPageTemplate="#{BundleBDIntegrado.PaginatorFilasPorPagina}">
                        
                            <p:ajax event="rowSelect" listener="#{sspRegistroCursoController.seleccionarFilaTablaCurso}" update="@form" process="@form" />
                            <p:ajax event="rowUnselect" listener="#{sspRegistroCursoController.deseleccionarFilaTablaCurso}" update="@form" process="@form" />
                            <p:ajax event="rowSelectCheckbox" listener="#{sspRegistroCursoController.seleccionarFilaTablaCurso}" update="@form" process="@form" />
                            <p:ajax event="rowUnselectCheckbox" listener="#{sspRegistroCursoController.deseleccionarFilaTablaCurso}" update="@form" process="@form" />
                            <p:ajax event="toggleSelect" listener="#{sspRegistroCursoController.toggleEventFilaCurso(event)}" update="@form" process="@form" />
                        
                            <p:column selectionMode="multiple" style="width:16px;text-align:center"  />
                            <p:column headerText="#{BundleBDIntegrado.sspCursos_list_dtListado_id}" style="text-align: center;" >
                                <h:outputText value="#{itemReg.id}" />
                            </p:column>
                            <p:column headerText="#{BundleBDIntegrado.sspCursos_list_dtListado_nroExpediente}" style="text-align: center;" >
                                <h:outputText value="#{itemReg.nroExpediente}" />
                            </p:column>
                            <p:column headerText="#{BundleBDIntegrado.sspCursos_list_dtListado_fechaTransmision}" style="text-align: center;" >
                                <h:outputText value="#{sspRegistroCursoController.obtenerFechaTransmision(itemReg)}">
                                    <f:convertDateTime pattern="#{BundleBDIntegrado.FormatoFecha}" />
                                </h:outputText>
                            </p:column>
                            <p:column headerText="#{BundleBDIntegrado.sspCursos_list_dtListado_locales}" style="text-align: center;" >
                                <p:commandButton icon="ui-icon-search"
                                                 process="@this,buscarDatatableRegistro"
                                                 update="@this,buscarDatatableRegistro"
                                                 value="Ver"
                                                 title="Ver locales"
                                                 id="btnVerLocales"
                                                 actionListener="#{sspRegistroCursoController.openDlgVerLocales(itemReg) }" >
                                </p:commandButton>
                            </p:column>
                            <p:column headerText="#{BundleBDIntegrado.sspCursos_list_dtListado_instructores}" style="text-align: center;" >
                                <p:commandButton icon="ui-icon-search"
                                                 process="@this,buscarDatatableRegistro"
                                                 update="@this,buscarDatatableRegistro"
                                                 value="Ver"
                                                 title="Ver Instructores"
                                                 id="btnVerInstructores"
                                                 actionListener="#{sspRegistroCursoController.openDlgVerInstructores(itemReg) }" >
                                </p:commandButton>
                            </p:column>
                            <p:column headerText="#{BundleBDIntegrado.sspCursos_list_dtListado_prospectoVigilantes}" style="text-align: center;" >
                                <p:commandButton icon="ui-icon-search"
                                                 process="@this,buscarDatatableRegistro"
                                                 update="@this,buscarDatatableRegistro"
                                                 value="Ver"
                                                 title="Ver Vigilantes"
                                                 id="btnVerVigilantes"
                                                 actionListener="#{sspRegistroCursoController.openDlgVerVigilantes(itemReg) }" >
                                </p:commandButton>
                            </p:column>
                            <p:column headerText="#{BundleBDIntegrado.sspCursos_list_dtListado_tipoServicio}" style="text-align: center;" >
                                <h:outputText value="#{sspRegistroCursoController.obtenerTipoServicioBandeja(itemReg)}" />
                            </p:column>
                            <p:column headerText="#{BundleBDIntegrado.sspCursos_list_dtListado_tipoformación}" style="text-align: center;" >
                                <h:outputText value="#{sspRegistroCursoController.obtenerTipoFormacionCursoBandeja(itemReg)}" />
                            </p:column>
                            <p:column headerText="#{BundleBDIntegrado.sspCursos_list_dtListado_fechaInicioCurso}" style="text-align: center;" >
                                <h:outputText value="#{sspRegistroCursoController.obtenerFechaInicioBandeja(itemReg) }" />
                            </p:column>
                            <p:column headerText="#{BundleBDIntegrado.sspCursos_list_dtListado_estado}" style="text-align: center;" >
                                <h:outputText value="#{itemReg.estadoId.nombre}" />
                            </p:column>
                            <p:column headerText="#{BundleBDIntegrado.sspCursos_list_dtListado_acciones}" style="text-align: center;" >
                                <p:commandButton update="@form"
                                             icon="ui-icon-search"
                                             ajax="false"
                                             title="#{BundleBDIntegrado.sspCursos_list_verCurso}"
                                             rendered="#{sspRegistroCursoController.renderBtnVer(itemReg.estadoId)}"
                                             actionListener="#{sspRegistroCursoController.mostrarVer(itemReg, false)}" >
                                </p:commandButton>
                                <p:commandButton update="@form"
                                             icon="ui-icon-pencil"
                                             ajax="false"
                                             title="#{BundleBDIntegrado.sspCursos_list_editarCurso}"
                                             rendered="#{sspRegistroCursoController.renderBtnEditar(itemReg)}"
                                             actionListener="#{sspRegistroCursoController.mostrarEditar(itemReg)}" >
                                </p:commandButton>
                                <p:commandButton update="@form"
                                             icon="ui-icon-pencil"
                                             ajax="false"
                                             title="#{BundleBDIntegrado.sspCursos_list_editarCurso}"
                                             rendered="#{sspRegistroCursoController.renderBtnEditarDocumentos(itemReg)}"
                                             actionListener="#{sspRegistroCursoController.mostrarActualizar(itemReg, false)}" >
                                </p:commandButton>
                                <p:commandButton update="@form"
                                             icon="ui-icon-trash"
                                             styleClass="botonBorrar"
                                             title="#{BundleBDIntegrado.sspCursos_list_borrarCurso}"
                                             rendered="#{sspRegistroCursoController.renderBtnBorrar(itemReg)}"
                                             actionListener="#{sspRegistroCursoController.borrarRegistro(itemReg)}" >
                                    <p:confirm header="Confirmación" message="#{BundleBDIntegrado.ConfirmarEliminar}" icon="ui-icon-alert" />
                                </p:commandButton>
                                <p:commandButton update="@form"
                                             icon="ui-icon-refresh"
                                             ajax="false"
                                             title="#{BundleBDIntegrado.sspCursos_list_leyenda_modificatoriaCurso}"
                                             rendered="#{sspRegistroCursoController.renderBtnModificatoria(itemReg)}"
                                             actionListener="#{sspRegistroCursoController.mostrarModificatoria(itemReg)}" >
                                </p:commandButton>
                                <p:commandButton  icon="ui-icon-print"
                                                  id ="btnImprimir"
                                                  ajax="false"
                                                  rendered="#{sspRegistroCursoController.renderBtnImprimir(itemReg)}"
                                                  process="@all"
                                                  onclick="this.form.target = '_blank'"
                                                  onblur="this.form.target = '_self'"
                                                  immediate="true" >
                                    <p:fileDownload value="#{sspRegistroCursoController.imprimirConstancia(itemReg)}" contentDisposition="inline" />
                                </p:commandButton>
                            </p:column>
                        </p:dataTable>
                    <br/>
                </h:panelGrid>                                   
            </h:form>
            
            <ui:include src="Edit.xhtml" />
            <ui:include src="View.xhtml" />
            <ui:include src="ModificatoriaCurso.xhtml" />
            <ui:include src="dlgBuscarMapa.xhtml" />
            <ui:include src="dlgBuscarLocal.xhtml" />
            <ui:include src="dlgVerLocal.xhtml" />
            <ui:include src="dlgVerInstructor.xhtml" />
            <ui:include src="dlgVerVigilantes.xhtml" />
            <ui:include src="dlgVerNota.xhtml" />
            <ui:include src="dlgCambiarLocal.xhtml" />
            <ui:include src="dlgCambiarInstructor.xhtml" />
            <ui:include src="dlgConfirmarCambioLocal.xhtml" />
            <ui:include src="dlgConfirmarCambioInstructor.xhtml" />
            <ui:include src="dlgMediosContacto.xhtml" />
            <ui:include src="dlgFoto.xhtml" />
            <ui:include src="dlgVerMapa.xhtml" />
            <ui:include src="ConfirmarNota.xhtml" />
            <ui:include src="dlgConfirmarCancelacion.xhtml" />
            <ui:include src="dlgVerDatosInstructor.xhtml" />
            <ui:include src="dlgCambiarHorario.xhtml" />
            <ui:include src="dlgActualizarNota.xhtml" />
            <ui:include src="dlgComunicadoTransmitir.xhtml" />
        </ui:define>
    </ui:composition>
</html>